function setSecupayObject(){var e={prepay:"pay-with-prepay",secupay:"pay-with-secupay",secupaycc:"pay-with-secupaycc"},r=jQuery("form#payment-form");return{payTypes:e,txnVars:{type:jQuery(r).data("type"),free:jQuery(r).data("free"),txn_type:jQuery(r).data("txn-type")}}}jQuery(document).ready(function(){function e(){jQuery(document).trigger("idc_no_methods"),jQuery(document).trigger("idc_tps_option")}function r(e,r){var t=jQuery("#payment-form #logged-input").hasClass("yes"),a=e.substring(0,1).toUpperCase()+e.substring(1);jQuery("#id-main-submit").removeAttr("disabled").attr("name","submitPayment"+a).text(r);var i=jQuery(".product-price").text();idcSetPriceText("prepay","â‚¬",i),jQuery(".finaldesc").hide()}secupayObj=setSecupayObject(),"recurring"==secupayObj.txnVars.type||"free"==secupayObj.txnVars.free?jQuery.each(secupayObj.payTypes,function(e,r){jQuery("#"+r).remove()}):"preauth"==secupayObj.txnVars.txn_type&&jQuery.each(secupayObj.payTypes,function(e,r){"pay-with-secupaycc"!==r&&"pay-with-secupay"!==r&&jQuery("#"+r).remove()}),jQuery(document).bind("idcPaySelect",function(e,t){var a=jQuery(t).attr("id").replace("pay-with-",""),i;switch(a){case"prepay":i=idc_localization_strings.pay_with_prepay,r(a,i),jQuery("#stripe-input").hide(),jQuery(".pw").parents(".form-row").hide(),jQuery(".cpw").parents(".form-row").hide(),jQuery("#finaldescPrepay").show();break;case"secupay":i=idc_localization_strings.pay_with_secupay,r(a,i),jQuery("#stripe-input").hide(),jQuery(".pw").parents(".form-row").hide(),jQuery(".cpw").parents(".form-row").hide(),jQuery("#finaldescSecupay").show();break;case"secupaycc":i=idc_localization_strings.pay_with_cc,r(a,i),jQuery("#stripe-input").hide(),jQuery(".pw").parents(".form-row").hide(),jQuery(".cpw").parents(".form-row").hide(),jQuery("#finaldescSecupay").show();break}}),jQuery(document).bind("idcCheckoutSubmit",function(e,r){if(e.preventDefault(),0==r.includes("Secupay")&&0==r.includes("Prepay"))return!1;var t=idcCheckoutCustomer(),a=idcCheckoutExtraFields(),i=parseFloat(jQuery('input[name="pwyw-price"]').val()),u=window.location.href;jQuery.ajax({url:memberdeck_ajaxurl,type:"POST",data:{action:"id_secupay_submit",submit_name:r,customer:t,fields:a.posts,pwyw_price:i,current_url:u},success:function(e){if("string"==typeof e){var t=JSON.parse(e);if(void 0!==t.message&&void 0!==t.message.iframe_url){var a={type:"iframe",source:t.message.iframe_url};openLBGlobal(a)}else jQuery('button[name="'+r+'"]').removeAttr("disabled").removeClass("processing"),jQuery(".payment-errors").text(t.message)}}})}),jQuery(document).bind("idc_lightbox_global",function(e,r){"object"==typeof r&&r.source.indexOf("secupay")}),jQuery(document).bind("idc_close_lightbox_global",function(e,r){"object"==typeof r&&void 0!==r.source&&r.source.indexOf("secupay")>0&&jQuery("#id-main-submit").removeAttr("disabled").removeClass("processing")})});